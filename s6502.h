enum AddressType {
None,           // invalid
Impl,Accu,      // 1 byte opcodes
Rela,Imme,      // 2 byte opcodes
Zpag,Zpgx,Zpgy, // 2 byte zero page modes
Abso,Absx,Absy, // 3 byte absolute modes
Indi,Indx,Indy  //   indirect modes
};

struct s6502
{
   int  len;
   int  amo;
   char mne[8];
   char pre[8];
   char pos[8];
   char fmt[8];
};

struct s6502 set[256] = 
{
   { 1, Impl, "BRK", "" , ""   , ""       },   // 00
   { 2, Indx, "ORA", "(", ",X)", "(%s,X)" },   // 01
   { 0, None, "---", "" , ""   , ""       },   // 02
   { 0, None, "---", "" , ""   , ""       },   // 03
   { 0, None, "---", "" , ""   , ""       },   // 04
   { 2, Zpag, "ORA", "" , ""   , "%s"     },   // 05
   { 2, Zpag, "ASL", "" , ""   , "%s"     },   // 06
   { 0, None, "---", "" , ""   , ""       },   // 07
   { 1, Impl, "PHP", "" , ""   , ""       },   // 08
   { 2, Imme, "ORA", "#", ""   , "#%s"    },   // 09
   { 1, Accu, "ASL", "A", ""   , "A"      },   // 0a
   { 0, None, "---", "" , ""   , ""       },   // 0b
   { 0, None, "---", "" , ""   , ""       },   // 0c
   { 3, Abso, "ORA", "" , ""   , "%s"     },   // 0d
   { 3, Abso, "ASL", "" , ""   , "%s"     },   // 0e
   { 0, None, "---", "" , ""   , ""       },   // 0f

   { 2, Rela, "BPL", "" , ""   , "%s"     },   // 10
   { 2, Indy, "ORA", "(", "),Y", "(%s),Y" },   // 11
   { 0, None, "---", "" , ""   , ""       },   // 12
   { 0, None, "---", "" , ""   , ""       },   // 13
   { 0, None, "---", "" , ""   , ""       },   // 14
   { 2, Zpgx, "ORA", "" , ",X" , "%s,X"   },   // 15
   { 2, Zpgx, "ASL", "" , ",X" , "%s,X"   },   // 16
   { 0, None, "---", "" , ""   , ""       },   // 17
   { 1, Impl, "CLC", "" , ""   , ""       },   // 18
   { 3, Absy, "ORA", "" , ",Y" , "%s,Y"   },   // 19
   { 0, None, "---", "" , ""   , ""       },   // 1a
   { 0, None, "---", "" , ""   , ""       },   // 1b
   { 0, None, "---", "" , ""   , ""       },   // 1c
   { 3, Absx, "ORA", "" , ",X" , "%s,X"   },   // 1d
   { 3, Absx, "ASL", "" , ",X" , "%s,X"   },   // 1e
   { 0, None, "---", "" , ""   , ""       },   // 1f

   { 3, Abso, "JSR", "" , ""   , "%s"     },   // 20
   { 2, Indx, "AND", "(", ",X)", "(%s,X)" },   // 21
   { 0, None, "---", "" , ""   , ""       },   // 22
   { 0, None, "---", "" , ""   , ""       },   // 23
   { 2, Zpag, "BIT", "" , ""   , "%s"     },   // 24
   { 2, Zpag, "AND", "" , ""   , "%s"     },   // 25
   { 2, Zpag, "ROL", "" , ""   , "%s"     },   // 26
   { 0, None, "---", "" , ""   , ""       },   // 27
   { 1, Impl, "PLP", "" , ""   , ""       },   // 28
   { 2, Imme, "AND", "#", ""   , "#%s"    },   // 29
   { 1, Accu, "ROL", "A", ""   , "A"      },   // 2a
   { 0, None, "---", "" , ""   , ""       },   // 2b
   { 3, Abso, "BIT", "" , ""   , "%s"     },   // 2c
   { 3, Abso, "AND", "" , ""   , "%s"     },   // 2d
   { 3, Abso, "ROL", "" , ""   , "%s"     },   // 2e
   { 0, None, "---", "" , ""   , ""       },   // 2f

   { 2, Rela, "BMI", "" , ""   , "%s"     },   // 30
   { 2, Indy, "AND", "(", "),Y", "(%s),Y" },   // 31
   { 0, None, "---", "" , ""   , ""       },   // 32
   { 0, None, "---", "" , ""   , ""       },   // 33
   { 0, None, "---", "" , ""   , ""       },   // 34
   { 2, Zpgx, "AND", "" , ",X" , "%s,X"   },   // 35
   { 2, Zpgx, "ROL", "" , ",X" , "%s,X"   },   // 36
   { 0, None, "---", "" , ""   , ""       },   // 37
   { 1, Impl, "SEC", "" , ""   , ""       },   // 38
   { 3, Absy, "AND", "" , ",Y" , "%s,Y"   },   // 39
   { 0, None, "---", "" , ""   , ""       },   // 3a
   { 0, None, "---", "" , ""   , ""       },   // 3b
   { 0, None, "---", "" , ""   , ""       },   // 3c
   { 3, Absx, "AND", "" , ",X" , "%s,X"   },   // 3d
   { 3, Absx, "ROL", "" , ",X" , "%s,X"   },   // 3e
   { 0, None, "---", "" , ""   , ""       },   // 3f

   { 1, Impl, "RTI", "" , ""   , ""       },   // 40
   { 2, Indx, "EOR", "(", ",X)", "(%s,X)" },   // 41
   { 0, None, "---", "" , ""   , ""       },   // 42
   { 0, None, "---", "" , ""   , ""       },   // 43
   { 0, None, "---", "" , ""   , ""       },   // 44
   { 2, Zpag, "EOR", "" , ""   , "%s"     },   // 45
   { 2, Zpag, "LSR", "" , ""   , "%s"     },   // 46
   { 0, None, "---", "" , ""   , ""       },   // 47
   { 1, Impl, "PHA", "" , ""   , ""       },   // 48
   { 2, Imme, "EOR", "#", ""   , "#%s"    },   // 49
   { 1, Accu, "LSR", "A", ""   , "A"      },   // 4a
   { 0, None, "---", "" , ""   , ""       },   // 4b
   { 3, Abso, "JMP", "" , ""   , "%s"     },   // 4c
   { 3, Abso, "EOR", "" , ""   , "%s"     },   // 4d
   { 3, Abso, "LSR", "" , ""   , "%s"     },   // 4e
   { 0, None, "---", "" , ""   , ""       },   // 4f

   { 2, Rela, "BVC", "" , ""   , "%s"     },   // 50
   { 2, Indy, "EOR", "(", "),Y", "(%s),Y" },   // 51
   { 0, None, "---", "" , ""   , ""       },   // 52
   { 0, None, "---", "" , ""   , ""       },   // 53
   { 0, None, "---", "" , ""   , ""       },   // 54
   { 2, Zpgx, "EOR", "" , ",X" , "%s,X"   },   // 55
   { 2, Zpgx, "LSR", "" , ",X" , "%s,X"   },   // 56
   { 0, None, "---", "" , ""   , ""       },   // 57
   { 1, Impl, "CLI", "" , ""   , ""       },   // 58
   { 3, Absy, "EOR", "" , ",Y" , "%s,Y"   },   // 59
   { 0, None, "---", "" , ""   , ""       },   // 5a
   { 0, None, "---", "" , ""   , ""       },   // 5b
   { 0, None, "---", "" , ""   , ""       },   // 5c
   { 3, Absx, "EOR", "" , ",X" , "%s,X"   },   // 5d
   { 3, Absx, "LSR", "" , ",X" , "%s,X"   },   // 5e
   { 0, None, "---", "" , ""   , ""       },   // 5f

   { 1, Impl, "RTS", "" , ""   , ""       },   // 60
   { 2, Indx, "ADC", "(", ",X)", "(%s,X)" },   // 61
   { 0, None, "---", "" , ""   , ""       },   // 62
   { 0, None, "---", "" , ""   , ""       },   // 63
   { 0, None, "---", "" , ""   , ""       },   // 64
   { 2, Zpag, "ADC", "" , ""   , "%s"     },   // 65
   { 2, Zpag, "ROR", "" , ""   , "%s"     },   // 66
   { 0, None, "---", "" , ""   , ""       },   // 67
   { 1, Impl, "PLA", "" , ""   , ""       },   // 68
   { 2, Imme, "ADC", "#", ""   , "#%s"    },   // 69
   { 1, Accu, "ROR", "A", ""   , "A"      },   // 6a
   { 0, None, "---", "" , ""   , ""       },   // 6b
   { 3, Indi, "JMP", "(", ")"  , "(%s)"   },   // 6c
   { 3, Abso, "ADC", "" , ""   , "%s"     },   // 6d
   { 3, Abso, "ROR", "" , ""   , "%s"     },   // 6e
   { 0, None, "---", "" , ""   , ""       },   // 6f

   { 2, Rela, "BVS", "" , ""   , "%s"     },   // 70
   { 2, Indy, "ADC", "(", "),Y", "(%s),Y" },   // 71
   { 0, None, "---", "" , ""   , ""       },   // 72
   { 0, None, "---", "" , ""   , ""       },   // 73
   { 0, None, "---", "" , ""   , ""       },   // 74
   { 2, Zpgx, "ADC", "" , ",X" , "%s,X"   },   // 75
   { 2, Zpgx, "ROR", "" , ",X" , "%s,X"   },   // 76
   { 0, None, "---", "" , ""   , ""       },   // 77
   { 1, Impl, "SEI", "" , ""   , ""       },   // 78
   { 3, Absy, "ADC", "" , ",Y" , "%s,Y"   },   // 79
   { 0, None, "---", "" , ""   , ""       },   // 7a
   { 0, None, "---", "" , ""   , ""       },   // 7b
   { 0, None, "---", "" , ""   , ""       },   // 7c
   { 3, Absx, "ADC", "" , ",X" , "%s,X"   },   // 7d
   { 3, Absx, "ROR", "" , ",X" , "%s,X"   },   // 7e
   { 0, None, "---", "" , ""   , ""       },   // 7f

   { 0, None, "---", "" , ""   , ""       },   // 80
   { 2, Indx, "STA", "(", ",X)", "(%s,X)" },   // 81
   { 0, None, "---", "" , ""   , ""       },   // 82
   { 0, None, "---", "" , ""   , ""       },   // 83
   { 2, Zpag, "STY", "" , ""   , "%s"     },   // 84
   { 2, Zpag, "STA", "" , ""   , "%s"     },   // 85
   { 2, Zpag, "STX", "" , ""   , "%s"     },   // 86
   { 0, None, "---", "" , ""   , ""       },   // 87
   { 1, Impl, "DEY", "" , ""   , ""       },   // 88
   { 0, None, "---", "" , ""   , ""       },   // 89
   { 1, Impl, "TXA", "" , ""   , ""       },   // 8a
   { 0, None, "---", "" , ""   , ""       },   // 8b
   { 3, Abso, "STY", "" , ""   , "%s"     },   // 8c
   { 3, Abso, "STA", "" , ""   , "%s"     },   // 8d
   { 3, Abso, "STX", "" , ""   , "%s"     },   // 8e
   { 0, None, "---", "" , ""   , ""       },   // 8f

   { 2, Rela, "BCC", "" , ""   , "%s"     },   // 90
   { 2, Indy, "STA", "(", "),Y", "(%s),Y" },   // 91
   { 0, None, "---", "" , ""   , ""       },   // 92
   { 0, None, "---", "" , ""   , ""       },   // 93
   { 2, Zpgx, "STY", "" , ",X" , "%s,X"   },   // 94
   { 2, Zpgx, "STA", "" , ",X" , "%s,X"   },   // 95
   { 2, Zpgy, "STX", "" , ",Y" , "%s,Y"   },   // 96
   { 0, None, "---", "" , ""   , ""       },   // 97
   { 1, Impl, "TYA", "" , ""   , ""       },   // 98
   { 3, Absy, "STA", "" , ",Y" , "%s,Y"   },   // 99
   { 1, Impl, "TXS", "" , ""   , ""       },   // 9a
   { 0, None, "---", "" , ""   , ""       },   // 9b
   { 0, None, "---", "" , ""   , ""       },   // 9c
   { 3, Absx, "STA", "" , ",X" , "%s,X"   },   // 9d
   { 0, None, "---", "" , ""   , ""       },   // 9e
   { 0, None, "---", "" , ""   , ""       },   // 9f

   { 2, Imme, "LDY", "#", ""   , "#%s"    },   // a0
   { 2, Indx, "LDA", "(", ",X)", "(%s,X)" },   // a1
   { 2, Imme, "LDX", "#", ""   , "#%s"    },   // a2
   { 0, None, "---", "" , ""   , ""       },   // a3
   { 2, Zpag, "LDY", "" , ""   , "%s"     },   // a4
   { 2, Zpag, "LDA", "" , ""   , "%s"     },   // a5
   { 2, Zpag, "LDX", "" , ""   , "%s"     },   // a6
   { 0, None, "---", "" , ""   , ""       },   // a7
   { 1, Impl, "TAY", "" , ""   , ""       },   // a8
   { 2, Imme, "LDA", "#", ""   , "#%s"    },   // a9
   { 1, Impl, "TAX", "" , ""   , ""       },   // aa
   { 0, None, "---", "" , ""   , ""       },   // ab
   { 3, Abso, "LDY", "" , ""   , "%s"     },   // ac
   { 3, Abso, "LDA", "" , ""   , "%s"     },   // ad
   { 3, Abso, "LDX", "" , ""   , "%s"     },   // ae
   { 0, None, "---", "" , ""   , ""       },   // af

   { 2, Rela, "BCS", "" , ""   , "%s"     },   // b0
   { 2, Indy, "LDA", "(", "),Y", "(%s),Y" },   // b1
   { 0, None, "---", "" , ""   , ""       },   // b2
   { 0, None, "---", "" , ""   , ""       },   // b3
   { 2, Zpgx, "LDY", "" , ",X" , "%s,X"   },   // b4
   { 2, Zpgx, "LDA", "" , ",X" , "%s,X"   },   // b5
   { 2, Zpgy, "LDX", "" , ",Y" , "%s,Y"   },   // b6
   { 0, None, "---", "" , ""   , ""       },   // b7
   { 1, Impl, "CLV", "" , ""   , ""       },   // b8
   { 3, Absy, "LDA", "" , ",Y" , "%s,Y"   },   // b9
   { 1, Impl, "TSX", "" , ""   , ""       },   // ba
   { 0, None, "---", "" , ""   , ""       },   // bb
   { 3, Absx, "LDY", "" , ",X" , "%s,X"   },   // bc
   { 3, Absx, "LDA", "" , ",X" , "%s,X"   },   // bd
   { 3, Absy, "LDX", "" , ",Y" , "%s,Y"   },   // be
   { 0, None, "---", "" , ""   , ""       },   // bf

   { 2, Imme, "CPY", "#", ""   , "#%s"    },   // c0
   { 2, Indx, "CMP", "(", ",X)", "(%s,X)" },   // c1
   { 0, None, "---", "" , ""   , ""       },   // c2
   { 0, None, "---", "" , ""   , ""       },   // c3
   { 2, Zpag, "CPY", "" , ""   , "%s"     },   // c4
   { 2, Zpag, "CMP", "" , ""   , "%s"     },   // c5
   { 2, Zpag, "DEC", "" , ""   , "%s"     },   // c6
   { 0, None, "---", "" , ""   , ""       },   // c7
   { 1, Impl, "INY", "" , ""   , ""       },   // c8
   { 2, Imme, "CMP", "#", ""   , "#%s"    },   // c9
   { 1, Impl, "DEX", "" , ""   , ""       },   // ca
   { 0, None, "---", "" , ""   , ""       },   // cb
   { 3, Abso, "CPY", "" , ""   , "%s"     },   // cc
   { 3, Abso, "CMP", "" , ""   , "%s"     },   // cd
   { 3, Abso, "DEC", "" , ""   , "%s"     },   // ce
   { 0, None, "---", "" , ""   , ""       },   // cf

   { 2, Rela, "BNE", "" , ""   , "%s"     },   // d0
   { 2, Indy, "CMP", "(", "),Y", "(%s),Y" },   // d1
   { 0, None, "---", "" , ""   , ""       },   // d2
   { 0, None, "---", "" , ""   , ""       },   // d3
   { 0, None, "---", "" , ""   , ""       },   // d4
   { 2, Zpgx, "CMP", "" , ",X" , "%s,X"   },   // d5
   { 2, Zpgx, "DEC", "" , ",X" , "%s,X"   },   // d6
   { 0, None, "---", "" , ""   , ""       },   // d7
   { 1, Impl, "CLD", "" , ""   , ""       },   // d8
   { 3, Absy, "CMP", "" , ",Y" , "%s,Y"   },   // d9
   { 0, None, "---", "" , ""   , ""       },   // da
   { 0, None, "---", "" , ""   , ""       },   // db
   { 0, None, "---", "" , ""   , ""       },   // dc
   { 3, Absx, "CMP", "" , ",X" , "%s,X"   },   // dd
   { 3, Absx, "DEC", "" , ",X" , "%s,X"   },   // de
   { 0, None, "---", "" , ""   , ""       },   // df

   { 2, Imme, "CPX", "#", ""   , "#%s"    },   // e0
   { 2, Indx, "SBC", "(", ",X)", "(%s,X)" },   // e1
   { 0, None, "---", "" , ""   , ""       },   // e2
   { 0, None, "---", "" , ""   , ""       },   // e3
   { 2, Zpag, "CPX", "" , ""   , "%s"     },   // e4
   { 2, Zpag, "SBC", "" , ""   , "%s"     },   // e5
   { 2, Zpag, "INC", "" , ""   , "%s"     },   // e6
   { 0, None, "---", "" , ""   , ""       },   // e7
   { 1, Impl, "INX", "" , ""   , ""       },   // e8
   { 2, Imme, "SBC", "#", ""   , "#%s"    },   // e9
   { 1, Impl, "NOP", "" , ""   , ""       },   // ea
   { 0, None, "---", "" , ""   , ""       },   // eb
   { 3, Abso, "CPX", "" , ""   , "%s"     },   // ec
   { 3, Abso, "SBC", "" , ""   , "%s"     },   // ed
   { 3, Abso, "INC", "" , ""   , "%s"     },   // ee
   { 0, None, "---", "" , ""   , ""       },   // ef

   { 2, Rela, "BEQ", "" , ""   , "%s"     },   // f0
   { 2, Indy, "SBC", "(", "),Y", "(%s),Y" },   // f1
   { 0, None, "---", "" , ""   , ""       },   // f2
   { 0, None, "---", "" , ""   , ""       },   // f3
   { 0, None, "---", "" , ""   , ""       },   // f4
   { 2, Zpgx, "SBC", "" , ",X" , "%s,X"   },   // f5
   { 2, Zpgx, "INC", "" , ",X" , "%s,X"   },   // f6
   { 0, None, "---", "" , ""   , ""       },   // f7
   { 1, Impl, "SED", "" , ""   , ""       },   // f8
   { 3, Absy, "SBC", "" , ",Y" , "%s,Y"   },   // f9
   { 0, None, "---", "" , ""   , ""       },   // fa
   { 0, None, "---", "" , ""   , ""       },   // fb
   { 0, None, "---", "" , ""   , ""       },   // fc
   { 3, Absx, "SBC", "" , ",X" , "%s,X"   },   // fd
   { 3, Absx, "INC", "" , ",X" , "%s,X"   },   // fe
   { 0, None, "---", "" , ""   , ""       }    // ff
};

